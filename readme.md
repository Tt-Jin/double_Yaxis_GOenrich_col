# 双Y轴展示 GO 富集条形图

#### 1. 加载 tidyverse 包，包括 ggplot2, dplyr 等最常用的 R 包。

#### 2. 绘制柱状图

- 变量 -Log10(P value) 越大表示 P 值越小，那么我们画柱状图的时候就尽量按照 P 值从小到大的顺序排列。x 轴是 GO_terms，柱状图默认顺序会按照 GO_terms 的首字母从 a 到 z 的顺序排列，这和我们的目的不符。因此，需要自定义柱子顺序，这里使用 reorder() 函数，将 GO_terms 的顺序按照 -Log10(P value) 从大到小的顺序排列，值得注意的是，-Log10(P value)需要用 `` 而不是 '' 引用，可以防止 -Log10(P value) 前面的 - 被识别成运算符号。

#### 3. 绘制右侧 y 轴

- 要再添加一个 y 轴，我们需要先用 scale_y_continuous() 函数对 y 轴进行设置，用 sec.axis 参数添加次级 y 轴，次级 y 轴的刻度需要通过一级 y 轴的刻度调整而来，~./42 就表示次级 y 轴的范围是用一级 y 轴除以 42，得到符合于使用次级 y 轴的 -Log10(P value) 变量范围的刻度。（需要注意，自己的数据需要视具体情况调整）。 

- 设置好坐标轴就可以继续添加图层了，就是 p 值的点图和折线图。分别用 geom_line() 函数和 geom_point() 函数添加。同样的顺序还是要和之前一样调整。

- 值得注意的是，y 轴需要用 y=-Log10(P value)*42， 因为真正映射到图上位置时还是会按照一级 y 轴的刻度范围，而次级 y 轴刻度只是我们自己标上去的，不代表真实位置，前面次级 y 轴刻度由一级 y 轴除以 42 得到，所以这里需要将实际值乘以 42。

#### 4. 添加文本标签

- 使用 geom_text() 函数添加文本标签，同样的顺序还是要和之前一样调整，vjust用来调整标签相对高度位置。

- 值得注意的是，这个文本图层要放在点图和折线图之后再叠加，这样文本才不会被点和线覆盖住。

#### 5. 添加图例

- 这个图例不像是我们平时绘图的那种，这里是用 annotate() 等函数添加的。

#### 

### 最重要的是：

码代码不易，如果你觉得我的教程对你有帮助，请**小红书 - Ttian6688**关注我！！！
